vbcc
parse
(top
  {}
  (file
    (group
      (type)
      (globalid 7:@A_or_B)
      (=)
      (globalid 2:@A)
      (union)
      (globalid 2:@B)
      (class)
      (globalid 10:@closure_a)
      (globalid 2:@f)
      (:)
      (globalid 7:@A_or_B)
      (globalid 6:@apply)
      (globalid 16:@closure_a_apply)
      (class)
      (globalid 2:@A)
      (globalid 2:@f)
      (:)
      (globalid 2:@B)
      (class)
      (globalid 2:@B)
      (globalid 2:@f)
      (:)
      (bool)
      (func)
      (globalid 16:@closure_a_apply)
      (lparen)
      (localid 5:$self)
      (:)
      (globalid 10:@closure_a)
      (rparen)
      (:)
      (globalid 7:@A_or_B)
      (localid 10:$field_ref)
      (=)
      (ref)
      (localid 5:$self)
      (globalid 2:@f)
      (localid 6:$field)
      (=)
      (load)
      (localid 10:$field_ref)
      (ret)
      (localid 6:$field)
      (func)
      (globalid 10:@behavior1)
      (lparen)
      (localid 6:$cown1)
      (:)
      (ref)
      (globalid 7:@A_or_B)
      (rparen)
      (:)
      (globalid 7:@A_or_B)
      (localid 3:$a1)
      (=)
      (load)
      (localid 6:$cown1)
      (localid 6:$false)
      (=)
      (const)
      (bool)
      (false)
      (localid 2:$b)
      (=)
      (heap)
      (localid 3:$a1)
      (globalid 2:@B)
      (lparen)
      (localid 6:$false)
      (rparen)
      (localid 3:$a2)
      (=)
      (new)
      (globalid 2:@A)
      (lparen)
      (localid 2:$b)
      (rparen)
      (localid 4:$old)
      (=)
      (store)
      (localid 6:$cown1)
      (localid 3:$a2)
      (localid 4:$new)
      (=)
      (load)
      (localid 6:$cown1)
      (localid 3:$b2)
      (=)
      (region)
      (rc)
      (globalid 2:@B)
      (lparen)
      (localid 6:$false)
      (rparen)
      (localid 6:$extra)
      (=)
      (store)
      (localid 6:$cown1)
      (localid 3:$b2)
      (ret)
      (localid 4:$new)
      (func)
      (globalid 5:@main)
      (lparen)
      (rparen)
      (:)
      (i32)
      (localid 5:$true)
      (=)
      (const)
      (bool)
      (true)
      (localid 2:$b)
      (=)
      (region)
      (rc)
      (globalid 2:@B)
      (lparen)
      (localid 5:$true)
      (rparen)
      (localid 10:$closure_a)
      (=)
      (heap)
      (localid 2:$b)
      (globalid 10:@closure_a)
      (lparen)
      (localid 2:$b)
      (rparen)
      (localid 16:$closure_a_apply)
      (=)
      (lookup)
      (localid 10:$closure_a)
      (globalid 6:@apply)
      (drop)
      (localid 2:$b)
      (localid 6:$cown1)
      (=)
      (when)
      (localid 16:$closure_a_apply)
      (lparen)
      (localid 10:$closure_a)
      (rparen)
      (:)
      (globalid 7:@A_or_B)
      (localid 6:$cown2)
      (=)
      (when)
      (globalid 10:@behavior1)
      (lparen)
      (localid 6:$cown1)
      (rparen)
      (:)
      (globalid 7:@A_or_B)
      (localid 8:$ret_val)
      (=)
      (const)
      (i32)
      (int 2:42)
      (ret)
      (localid 8:$ret_val))))
