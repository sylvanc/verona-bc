vbcc
parse
(top
  {}
  (file
    (group
      (lib)
      (globalid 9:@printval)
      (=)
      (string 8:printval)
      (lparen)
      (dyn)
      (rparen)
      (:)
      (none)
      (class)
      (globalid 13:@closure_bool)
      (globalid 4:@val)
      (:)
      (bool)
      (globalid 6:@apply)
      (globalid 19:@closure_bool_apply)
      (func)
      (globalid 19:@closure_bool_apply)
      (lparen)
      (localid 5:$self)
      (:)
      (globalid 13:@closure_bool)
      (rparen)
      (:)
      (bool)
      (localid 8:$val_ref)
      (=)
      (ref)
      (localid 5:$self)
      (globalid 4:@val)
      (localid 2:$r)
      (=)
      (load)
      (localid 8:$val_ref)
      (ret)
      (localid 2:$r)
      (class)
      (globalid 12:@closure_i32)
      (globalid 4:@val)
      (:)
      (i32)
      (globalid 6:@apply)
      (globalid 18:@closure_i32_apply)
      (func)
      (globalid 18:@closure_i32_apply)
      (lparen)
      (localid 5:$self)
      (:)
      (globalid 12:@closure_i32)
      (rparen)
      (:)
      (i32)
      (localid 8:$val_ref)
      (=)
      (ref)
      (localid 5:$self)
      (globalid 4:@val)
      (localid 2:$r)
      (=)
      (load)
      (localid 8:$val_ref)
      (ret)
      (localid 2:$r)
      (class)
      (globalid 10:@behavior1)
      (globalid 2:@a)
      (:)
      (i32)
      (globalid 6:@apply)
      (globalid 16:@behavior1_apply)
      (func)
      (globalid 16:@behavior1_apply)
      (lparen)
      (localid 5:$self)
      (:)
      (globalid 10:@behavior1)
      (,)
      (localid 8:$cown1_v)
      (:)
      (ref)
      (bool)
      (,)
      (localid 8:$cown2_v)
      (:)
      (ref)
      (i32)
      (rparen)
      (:)
      (i32)
      (localid 6:$a_ref)
      (=)
      (ref)
      (localid 5:$self)
      (globalid 2:@a)
      (localid 2:$a)
      (=)
      (load)
      (localid 6:$a_ref)
      (localid 5:$prev)
      (=)
      (load)
      (localid 8:$cown1_v)
      (localid 5:$next)
      (=)
      (not)
      (localid 5:$prev)
      (localid 2:$0)
      (=)
      (store)
      (localid 8:$cown1_v)
      (localid 5:$next)
      (localid 2:$1)
      (=)
      (ffi)
      (globalid 9:@printval)
      (lparen)
      (localid 5:$prev)
      (rparen)
      (localid 2:$2)
      (=)
      (ffi)
      (globalid 9:@printval)
      (lparen)
      (localid 5:$next)
      (rparen)
      (localid 2:$b)
      (=)
      (load)
      (localid 8:$cown2_v)
      (localid 2:$c)
      (=)
      (add)
      (localid 2:$a)
      (localid 2:$b)
      (ret)
      (localid 2:$c)
      (class)
      (globalid 10:@behavior2)
      (globalid 6:@apply)
      (globalid 16:@behavior2_apply)
      (func)
      (globalid 16:@behavior2_apply)
      (lparen)
      (localid 5:$self)
      (:)
      (globalid 10:@behavior2)
      (,)
      (localid 10:$promise_v)
      (:)
      (ref)
      (i32)
      (rparen)
      (:)
      (none)
      (localid 2:$a)
      (=)
      (load)
      (localid 10:$promise_v)
      (localid 2:$_)
      (=)
      (ffi)
      (globalid 9:@printval)
      (lparen)
      (localid 2:$a)
      (rparen)
      (ret)
      (localid 2:$_)
      (func)
      (globalid 5:@main)
      (lparen)
      (rparen)
      (:)
      (i32)
      (localid 5:$bool)
      (=)
      (const)
      (bool)
      (true)
      (localid 13:$closure_bool)
      (=)
      (region)
      (arena)
      (globalid 13:@closure_bool)
      (lparen)
      (localid 5:$bool)
      (rparen)
      (localid 4:$be1)
      (=)
      (lookup)
      (localid 13:$closure_bool)
      (globalid 6:@apply)
      (localid 6:$cown1)
      (=)
      (when)
      (localid 4:$be1)
      (lparen)
      (localid 13:$closure_bool)
      (rparen)
      (:)
      (bool)
      (localid 4:$i32)
      (=)
      (const)
      (i32)
      (int 2:42)
      (localid 12:$closure_i32)
      (=)
      (region)
      (arena)
      (globalid 12:@closure_i32)
      (lparen)
      (localid 4:$i32)
      (rparen)
      (localid 6:$cown2)
      (=)
      (when)
      (globalid 18:@closure_i32_apply)
      (lparen)
      (localid 12:$closure_i32)
      (rparen)
      (:)
      (i32)
      (localid 9:$ro_cown2)
      (=)
      (read)
      (localid 6:$cown2)
      (localid 9:$closure1)
      (=)
      (region)
      (arena)
      (globalid 10:@behavior1)
      (lparen)
      (localid 4:$i32)
      (rparen)
      (localid 8:$promise)
      (=)
      (when)
      (globalid 16:@behavior1_apply)
      (lparen)
      (localid 9:$closure1)
      (,)
      (localid 6:$cown1)
      (,)
      (localid 9:$ro_cown2)
      (rparen)
      (:)
      (i32)
      (localid 11:$ro_promise)
      (=)
      (read)
      (localid 8:$promise)
      (localid 9:$closure2)
      (=)
      (new)
      (globalid 10:@behavior2)
      (lparen)
      (rparen)
      (localid 4:$be4)
      (=)
      (lookup)
      (globalid 16:@behavior2_apply)
      (localid 2:$_)
      (=)
      (when)
      (localid 4:$be4)
      (lparen)
      (localid 9:$closure2)
      (,)
      (localid 11:$ro_promise)
      (rparen)
      (:)
      (none)
      (localid 5:$zero)
      (=)
      (const)
      (i32)
      (int 1:0)
      (ret)
      (localid 5:$zero))))
